<!DOCTYPE html>
<html>
    <head>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <title>Bultaco Owners Manuals</title>
        <link rel="stylesheet" href="./libs/jquery.mobile-1.4.5.min.css">
        <link rel="stylesheet" href="./libs/listview-grid.css">
        <script src="./libs/jquery-latest.min.js"></script>
        <script src="./libs/jquery.mobile-1.4.5.min.js"></script>
        <script type='text/javascript' src='./libs/knockout-3.5.0.js'></script>
        <script type="text/javascript" src='./libs/manuals.js'></script>
        <script type="text/javascript">
            var myViewModel= { "manuals": ko.observableArray() };
            $( document ).ready(function() {
                myViewModel.manuals(engManuals);
                ko.applyBindings(myViewModel);
                $( ".photopopup" ).on({
                    popupbeforeposition: function() {
                        var maxHeight = $( window ).height() - 60 + "px";
                        $( ".photopopup img" ).css( "max-height", maxHeight );
                    }
                });   
            });
            function go(img) {
                document.getElementById("manualImage").src = "./images/" + img;
                $( "#popManual" ).popup();    
                $( "#popManual" ).popup({ history: false });            
                $( "#popManual" ).popup({ positionTo: "window" });
                //$( "#popManual" ).popup({ transition: "flip" });
                $( "#popManual" ).popup("open");
            }
        </script>
    </head>
    <body>
        <div data-role="page" id="main-page" class="my-page" data-theme="b">
            <div data-role="header" data-position="fixed">
                <div class="ui-bar ui-bar-b" >
                    <h1>Bultaco Manuales</h1>
                    <a href="#nav-panel" data-icon="bars" data-iconpos="notext" class="ui-btn-right ui-link ui-btn ui-icon-bars ui-btn-icon-notext ui-shadow ui-corner-all" data-role="button" role="button""></a>
                </div>                
            </div>
            <div role="main" class="ui-content">
                <ul id="manual_list" data-role="listview" data-inset="true" data-filter="true" data-input="#filterable-input">
                    <!-- ko foreach: manuals -->
                        <li>
                            <a data-bind="click: function(){go(image);}" >
                                <img data-bind="attr:{src:'./images/' + image}" class="ui-li-thumb">
                                <h2 data-bind='text:name'></h2>
                                <p>
                                    <span data-bind='text:article'></span><br>
                                    <span>cc: </span><span data-bind='text:cc'></span><br>
                                    <span data-bind='text:edition'></span><span data-bind='text:", " + date'></span>
                                </p>
                                <p class="ui-li-aside">
                                    <span data-bind='text:model'></span>
                                    <!-- ko if: $data.condition && $data.condition=="replace" -->
                                    <span style="color:red"><b>!</b></span>
                                    <!-- /ko -->
                                </p>
                            </a>
                        </li>
                    <!-- /ko -->
                </ul>
            </div>
            <div data-role="popup" id="popManual" class="photopopup">
                <a href="#" data-bind="click:function(){$( '#popManual' ).popup( 'close' );}" data-role="button" data-theme="b" data-icon="delete" data-iconpos="notext" class="ui-btn-right">Close</a>
                <img id="manualImage">
            </div>

            <div data-role="panel" data-display="overlay" data-position="right" id="nav-panel">
                <h2>Buscar</h2>
                <input type="text" data-type="search" id="filterable-input" data-theme="a">
                <p>¡Ayuda! Siempre me interesan los manuales que faltan. Ponte en contacto conmigo si tienes información.</p>
                <p>Help! I am always interested in any missing manuals. Contact me if you have information.</p>
                <center>
                    <span>Pregunta o Comentarios:</span><br>
                    <a href="mailto:rwbook@columbus.rr.com">Robert Book</a><br><br><br>
                    <img src=http://counters.honesty.com/cgi-bin/honesty-counter.cgi?df=gen.12131569.00001>
                </center>                
            </div>
        </div>
    </body>
</html>